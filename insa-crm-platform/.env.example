# INSA CRM Platform - Environment Variables Template
# Copy this file to .env and fill in your actual values
# Generated: October 30, 2025
# Security Audit Remediation

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL Database URL (full connection string)
DATABASE_URL=postgresql://user:password@localhost:5432/insa_crm

# PostgreSQL Connection Details (individual components)
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_DB=insa_crm
POSTGRES_USER=insa_user
POSTGRES_PASSWORD=CHANGE_ME_IN_PRODUCTION

# ============================================================================
# APPLICATION SECURITY
# ============================================================================

# Flask Secret Key (generate with: openssl rand -hex 32)
SECRET_KEY=GENERATE_WITH_OPENSSL_RAND_HEX_32

# JWT Token Configuration
JWT_SECRET_KEY=GENERATE_WITH_OPENSSL_RAND_HEX_32
JWT_ACCESS_TOKEN_EXPIRES=3600  # seconds (1 hour)

# ============================================================================
# EXTERNAL SERVICES - ERPNEXT CRM
# ============================================================================

# ERPNext API Configuration
ERPNEXT_API_URL=http://100.100.101.1:9000
ERPNEXT_USERNAME=administrator
ERPNEXT_PASSWORD=CHANGE_ME

# ERPNext Alternative URL (if using different host)
# ERPNEXT_API_URL_ALT=http://100.105.64.109:9000

# ============================================================================
# EXTERNAL SERVICES - INVENTREE
# ============================================================================

# InvenTree Inventory Management
INVENTREE_URL=http://100.100.101.1:9600
INVENTREE_API_TOKEN=GENERATE_IN_INVENTREE_SETTINGS
INVENTREE_USERNAME=admin
INVENTREE_PASSWORD=CHANGE_ME

# ============================================================================
# EXTERNAL SERVICES - MAUTIC MARKETING
# ============================================================================

# Mautic Marketing Automation
MAUTIC_URL=http://100.100.101.1:9700
MAUTIC_API_TOKEN=GENERATE_IN_MAUTIC_SETTINGS
MAUTIC_USERNAME=admin
MAUTIC_PASSWORD=CHANGE_ME

# ============================================================================
# EXTERNAL SERVICES - N8N AUTOMATION
# ============================================================================

# n8n Workflow Automation
N8N_URL=http://100.100.101.1:5678
N8N_API_KEY=GENERATE_IN_N8N_SETTINGS
N8N_USERNAME=admin
N8N_PASSWORD=CHANGE_ME

# ============================================================================
# REDIS CACHE & MESSAGE BROKER
# ============================================================================

# Redis Configuration
REDIS_URL=redis://localhost:6379/0
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=  # Leave empty if no password
REDIS_DB=0

# ============================================================================
# EMAIL / SMTP CONFIGURATION
# ============================================================================

# SMTP Email Settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_FROM=noreply@insaautomation.com
SMTP_USER=your_email@gmail.com
SMTP_PASSWORD=APP_SPECIFIC_PASSWORD  # Generate in Gmail settings

# Email Alerts
ALERT_EMAIL=w.aroca@insaing.com

# ============================================================================
# VECTOR DATABASE - QDRANT
# ============================================================================

# Qdrant Vector Database (for RAG/semantic search)
QDRANT_HOST=100.107.50.52
QDRANT_PORT=6333
QDRANT_API_KEY=  # Optional, leave empty if no auth

# ============================================================================
# OBJECT STORAGE - MINIO
# ============================================================================

# MinIO Object Storage
MINIO_ENDPOINT=172.17.0.3:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=CHANGE_ME_IN_PRODUCTION
MINIO_SECURE=false  # true for HTTPS, false for HTTP

# ============================================================================
# AI SERVICES - CLAUDE
# ============================================================================

# Claude AI API (optional - only needed if not using subprocess mode)
CLAUDE_API_KEY=  # Leave empty to use Claude Code subprocess (zero cost)

# Claude Code subprocess path
CLAUDE_CODE_PATH=claude  # or full path: /usr/local/bin/claude

# ============================================================================
# MONITORING & OBSERVABILITY
# ============================================================================

# Prometheus Metrics
PROMETHEUS_PORT=9091
PROMETHEUS_MULTIPROC_DIR=/tmp

# Grafana Analytics
GRAFANA_URL=http://100.100.101.1:3002
GRAFANA_API_KEY=GENERATE_IN_GRAFANA_SETTINGS

# AlertManager
ALERTMANAGER_URL=http://localhost:9093

# ============================================================================
# APPLICATION SETTINGS
# ============================================================================

# Flask Environment
FLASK_ENV=production  # development | production
FLASK_DEBUG=false     # true | false

# Application Host & Port
APP_HOST=0.0.0.0
APP_PORT=5000

# INSA CRM API URL (for email tracking, quote links)
CRM_API_URL=http://100.100.101.1:8003

# Project Sizing API URL (for examples and documentation)
SIZING_API_URL=http://100.100.101.1:8008

# Whisper Voice Model
WHISPER_MODEL=base   # tiny | base | small | medium | large
WHISPER_DEVICE=cpu   # cpu | cuda

# ============================================================================
# FEATURE FLAGS
# ============================================================================

# Enable/Disable Features
ENABLE_VOICE_INPUT=true
ENABLE_RAG_SEARCH=true
ENABLE_AUTO_HEALING=true
ENABLE_METRICS=true
ENABLE_PROMETHEUS=true

# ============================================================================
# TIMEOUT CONFIGURATION (Updated Oct 30, 2025)
# ============================================================================

# API Execution Timeout (seconds)
API_TIMEOUT=300  # 5 minutes

# Standard Query Timeout (seconds)
STANDARD_QUERY_TIMEOUT=540  # 9 minutes

# Complex Query Timeout (seconds)
COMPLEX_QUERY_TIMEOUT=3600  # 1 hour

# Session Idle Timeout (seconds)
SESSION_IDLE_TIMEOUT=18000  # 5 hours (300 minutes)

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log Level (DEBUG | INFO | WARNING | ERROR | CRITICAL)
LOG_LEVEL=INFO

# Log Format
LOG_FORMAT=%(asctime)s - %(name)s - %(levelname)s - %(message)s

# Log File Path
LOG_FILE=/var/log/insa-crm/app.log

# ============================================================================
# SECURITY SETTINGS
# ============================================================================

# CORS Allowed Origins (comma-separated)
CORS_ORIGINS=http://localhost:8007,http://100.100.101.1:8007,https://iac1.tailc58ea3.ts.net

# Rate Limiting
RATE_LIMIT_LOGIN=5 per minute
RATE_LIMIT_API=100 per minute

# Session Configuration
SESSION_COOKIE_SECURE=true   # true for HTTPS only
SESSION_COOKIE_HTTPONLY=true
SESSION_COOKIE_SAMESITE=Lax

# ============================================================================
# DEVELOPMENT / TESTING
# ============================================================================

# Test Database URL (separate from production)
TEST_DATABASE_URL=postgresql://user:password@localhost:5432/insa_crm_test

# Enable Test Mode
TESTING=false

# ============================================================================
# DEPLOYMENT
# ============================================================================

# Environment Name
ENVIRONMENT=production  # development | staging | production

# Server Hostname
HOSTNAME=iac1.tailc58ea3.ts.net

# Tailscale Configuration
TAILSCALE_HOSTNAME=iac1

# ============================================================================
# BACKUP & RECOVERY
# ============================================================================

# Backup Directory
BACKUP_DIR=/var/backups/insa-crm

# Backup Retention (days)
BACKUP_RETENTION_DAYS=30

# ============================================================================
# PERFORMANCE TUNING
# ============================================================================

# Worker Processes (for production WSGI server)
WORKERS=4

# Worker Class
WORKER_CLASS=sync  # sync | gevent | eventlet

# Max Requests per Worker (restart after N requests)
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=50

# ============================================================================
# EXTERNAL INTEGRATIONS (Optional)
# ============================================================================

# GitHub Integration (for bug tracking)
GITHUB_TOKEN=GENERATE_IN_GITHUB_SETTINGS
GITHUB_REPO=WilBtc/InsaAutomationCorp

# Slack Notifications (optional)
SLACK_WEBHOOK_URL=

# Datadog APM (optional)
DATADOG_API_KEY=
DATADOG_APP_KEY=

# ============================================================================
# NOTES
# ============================================================================

# Generate Secure Random Values:
#   SECRET_KEY:       openssl rand -hex 32
#   JWT_SECRET_KEY:   openssl rand -hex 32
#   MINIO_SECRET_KEY: openssl rand -hex 20

# Password Requirements:
#   - Minimum 12 characters
#   - Include uppercase, lowercase, numbers, symbols
#   - Do not use dictionary words
#   - Rotate every 90 days in production

# Security Checklist:
#   [ ] All passwords changed from defaults
#   [ ] SECRET_KEY and JWT_SECRET_KEY generated randomly
#   [ ] .env file added to .gitignore
#   [ ] File permissions set to 600 (chmod 600 .env)
#   [ ] Production credentials different from development
#   [ ] API tokens rotated regularly

# Support:
#   Email: w.aroca@insaing.com
#   Organization: Insa Automation Corp
#   Documentation: ~/insa-crm-platform/README.md
